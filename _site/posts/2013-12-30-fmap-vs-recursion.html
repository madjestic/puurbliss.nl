<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="description" content>
      <meta name="author" content>
      <link rel="shortcut icon" href="docs-assets/ico/favicon.ico">

        <title>PuurBliss.nl - fmap versus recursion</title>

	<!-- Bootstrap core CSS -->
	<link href="../css/bootstrap.css" rel="stylesheet">

	<!-- Code syntax highlighting CSS -->
	<link href="../css/syntax.css" rel="stylesheet">

	<!-- Custom styles for this template -->
	<link href="../css/carousel.css" rel="stylesheet">
    </head>
<!-- NAVBAR
================================================== -->
    <body>
      <div class="navbar-wrapper">
	<div class="container">

          <div class="navbar navbar-inverse navbar-static-top" role="navigation">
            <div class="container">
              <div class="navbar-header">
		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="#">Project name</a>
              </div>
              <div class="navbar-collapse collapse">
		<ul class="nav navbar-nav">
                  <li class="active"><a href="#">Home</a></li>
                  <li><a href="#about">About</a></li>
                  <li><a href="#contact">Contact</a></li>
                  <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                      <li><a href="#">Action</a></li>
                      <li><a href="#">Another action</a></li>
                      <li><a href="#">Something else here</a></li>
                      <li class="divider"></li>
                      <li class="dropdown-header">Nav header</li>
                      <li><a href="#">Separated link</a></li>
                      <li><a href="#">One more separated link</a></li>
                    </ul>
                  </li>
		</ul>
              </div>
            </div>
          </div>

	</div>
      </div>


      <!-- Carousel
      ================================================== -->
      <!-- <div id="myCarousel" class="carousel slide" data-ride="carousel"> -->
      <!-- 	<\!-- Indicators -\-> -->
      <!-- 	<ol class="carousel-indicators"> -->
      <!--     <li data-target="#myCarousel" data-slide-to="0" class="active"></li> -->
      <!--     <li data-target="#myCarousel" data-slide-to="1"></li> -->
      <!--     <li data-target="#myCarousel" data-slide-to="2"></li> -->
      <!-- 	</ol> -->
      <!-- 	<div class="carousel-inner"> -->
      <!--     <div class="item active"> -->
      <!--       <img data-src="holder.js/900x500/auto/#777:#7a7a7a/text:First slide" alt="First slide"> -->
      <!--       <div class="container"> -->
      <!--         <div class="carousel-caption"> -->
      <!-- 		<h1>Example headline.</h1> -->
      <!-- 		<p>Note: If you're viewing this page via a <code>file://</code> URL, the "next" and "previous" Glyphicon buttons on the left and right might not load/display properly due to web browser security rules.</p> -->
      <!-- 		<p><a class="btn btn-lg btn-primary" href="#" role="button">Sign up today</a></p> -->
      <!--         </div> -->
      <!--       </div> -->
      <!--     </div> -->
      <!--     <div class="item"> -->
      <!--       <img data-src="holder.js/900x500/auto/#666:#6a6a6a/text:Second slide" alt="Second slide"> -->
      <!--       <div class="container"> -->
      <!--         <div class="carousel-caption"> -->
      <!-- 		<h1>Another example headline.</h1> -->
      <!-- 		<p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p> -->
      <!-- 		<p><a class="btn btn-lg btn-primary" href="#" role="button">Learn more</a></p> -->
      <!--         </div> -->
      <!--       </div> -->
      <!--     </div> -->
      <!--     <div class="item"> -->
      <!--       <img data-src="holder.js/900x500/auto/#555:#5a5a5a/text:Third slide" alt="Third slide"> -->
      <!--       <div class="container"> -->
      <!--         <div class="carousel-caption"> -->
      <!-- 		<h1>One more for good measure.</h1> -->
      <!-- 		<p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p> -->
      <!-- 		<p><a class="btn btn-lg btn-primary" href="#" role="button">Browse gallery</a></p> -->
      <!--         </div> -->
      <!--       </div> -->
      <!--     </div> -->
      <!-- 	</div> -->
      <!-- 	<a class="left carousel-control" href="#myCarousel" data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span></a> -->
      <!-- 	<a class="right carousel-control" href="#myCarousel" data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span></a> -->
      <!-- </div><\!-- /.carousel -\-> -->



      <!-- Marketing messaging and featurettes
      ================================================== -->
      <!-- Wrap the rest of the page in another container to center all the content. -->

      <div class="container marketing">
					
					<div class="container">
							<!-- content -->
							<div>
									<p class="small"><div> </div>
<div> </div>
<div> </div>
<div> </div>
<div> </div>
<div> </div>

<div class="info">
    Posted on December 30, 2013
    
</div>

<h2 id="fmap-vs.recursion">fmap vs. recursion</h2>
<p><br /><br />A):</p>
<pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">mapLabel ::</span>  <span class="dt">Eq</span> a <span class="ot">=&gt;</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> <span class="dt">Tree</span> a <span class="ot">-&gt;</span> <span class="dt">Tree</span> b
mapLabel f (<span class="dt">Node</span> label []) <span class="fu">=</span> <span class="dt">Node</span> (f label) []
mapLabel f (<span class="dt">Node</span> label subTrees) <span class="fu">=</span> (<span class="dt">Node</span> (f label) (subLeaves subTrees))
	<span class="kw">where</span> subLeaves [] <span class="fu">=</span> []
        subLeaves (t<span class="fu">:</span>ts)
            <span class="fu">|</span> leaf t    <span class="fu">=</span>  <span class="dt">Node</span> (f label) [] <span class="fu">:</span> subLeaves ts
			<span class="fu">|</span> otherwise <span class="fu">=</span>  <span class="dt">Node</span> (f label) (subLeaves subTrees) <span class="fu">:</span> subLeaves ts
                                      </code></pre>
<p>B):</p>
<pre class="sourceCode haskell"><code class="sourceCode haskell">fmap f (<span class="dt">Node</span> x ts) <span class="fu">=</span> <span class="dt">Node</span> (f x) (map (fmap f) ts)</code></pre>
<p><br /> The idea was to create a function that would walk through a tree-like data structure and do some stuff to it. First I spent 2 evenings designing (or understanding rather) a recursive patter-matching function. The evening I was able to compile it <em>and</em> produce the expected result – I felt quite content with myself…</p>
<p>C):</p>
<pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">mapLabel ::</span>  <span class="dt">Eq</span> a <span class="ot">=&gt;</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> <span class="dt">Tree</span> a <span class="ot">-&gt;</span> <span class="dt">Tree</span> b
mapLabel f (<span class="dt">Node</span> label []) <span class="fu">=</span> <span class="dt">Node</span> (f label) []
mapLabel f (<span class="dt">Node</span> label subTrees) <span class="fu">=</span> (<span class="dt">Node</span> (f label) (subLeaves subTrees))
    <span class="kw">where</span> subLeaves [] <span class="fu">=</span> []
        subLeaves (t<span class="fu">:</span>ts)
            <span class="fu">|</span> leaf t    <span class="fu">=</span>  <span class="dt">Node</span> (f label) [] <span class="fu">:</span> subLeaves ts
			<span class="fu">|</span> otherwise <span class="fu">=</span>  <span class="dt">Node</span> (f label) (subLeaves subTrees) <span class="fu">:</span> subLeaves ts
                <span class="kw">where</span> label    <span class="fu">=</span> rootLabel t</code></pre>
<p>Just look at the awe-inspiring complexity of it!.. How is it even possible that my humble mind was able to grasp that? Then I revisited some of the related source-code inside Data.Tree module:</p>
<p>D):</p>
<pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">instance</span> <span class="dt">Functor</span> <span class="dt">Tree</span> <span class="kw">where</span>
    fmap f (<span class="dt">Node</span> x ts) <span class="fu">=</span> <span class="dt">Node</span> (f x) (map (fmap f) ts)</code></pre>
<p>… So much for the awesome complexity. It turned out the the solution B) is functionally equivalent to A) and has additional benefit of being so much more concise and easy to re-factor into, say, this:</p>
<pre class="sourceCode haskell"><code class="sourceCode haskell">fmap f (<span class="dt">Node</span> x ts) <span class="fu">=</span> <span class="dt">Node</span> (f ts) (map (fmap f) ts)</code></pre>
<p>(This function will recursively operate on ts (pattern-matched to subForest members), rather than on the x (rootLabel), as in the function above, without loosing readability – ain’t that just peachy?):</p>
<p>Further example of the same principle:</p>
<pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">-- A and B are roughly equivalent:</span>
<span class="co">-- A:</span>
<span class="ot">gamma ::</span> <span class="dt">Tree</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Tree</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Tree</span> <span class="dt">Int</span>
gamma t k <span class="fu">=</span> <span class="dt">Node</span> a forest 
           <span class="kw">where</span> a      <span class="fu">=</span> (\[x, y] <span class="ot">-&gt;</span> x<span class="fu">*</span>y) <span class="fu">$</span> map read <span class="fu">$</span> map rootLabel [t,k]
                 forest <span class="fu">=</span> (multIntForests (subForest t) (subForest k)) 

<span class="ot">multIntTrees ::</span> <span class="dt">Tree</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Tree</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Tree</span> <span class="dt">Int</span>
multIntTrees <span class="fu">=</span> gamma
 

<span class="ot">multIntForests ::</span> [<span class="dt">Tree</span> <span class="dt">String</span>] <span class="ot">-&gt;</span> [<span class="dt">Tree</span> <span class="dt">String</span>]<span class="ot">-&gt;</span> [<span class="dt">Tree</span> <span class="dt">Int</span>]
multIntForests [] _ <span class="fu">=</span> []
multIntForests _ [] <span class="fu">=</span> []
multIntForests (t<span class="fu">:</span>ts) (k<span class="fu">:</span>ks) <span class="fu">=</span> gamma t k <span class="fu">:</span> multIntForests ts ks 


<span class="co">-- B:</span>
delta f (<span class="dt">Node</span> a ts) (<span class="dt">Node</span> b ks) <span class="fu">=</span> (<span class="dt">Node</span> (f a b) (zipWith (delta f) ts ks))</code></pre>
<p>… And more examples:</p>
<pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">-- A and B are equivalent:</span>
<span class="co">-- A:</span>
<span class="co">-- Aquire a tree with the number of sub-nodes as a value of the rootLabel:</span>
<span class="ot">members ::</span> <span class="dt">Tree</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Tree</span> <span class="dt">String</span>
members (<span class="dt">Node</span> x [])  <span class="fu">=</span> <span class="dt">Node</span> {rootLabel <span class="fu">=</span> <span class="st">&quot;0&quot;</span>, subForest <span class="fu">=</span> []}
members (<span class="dt">Node</span> x ts0) <span class="fu">=</span> <span class="dt">Node</span> {rootLabel <span class="fu">=</span> (show <span class="fu">$</span> length ts0), subForest <span class="fu">=</span> subNodes ts0}
     <span class="kw">where</span> subNodes []     <span class="fu">=</span> []
           subNodes [t]    <span class="fu">=</span> members t <span class="fu">:</span> []
           subNodes (t<span class="fu">:</span>ts) <span class="fu">=</span> (members t)<span class="fu">:</span> subNodes ts

<span class="co">-- B:</span>
<span class="ot">members ::</span> <span class="dt">Tree</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Tree</span> <span class="dt">String</span>
members <span class="fu">=</span> fmap length</code></pre>
</p>
							</div>
							<!-- /content -->

							<!-- FOOTER -->
							<footer>
									<p class="pull-right"><a href="#">Back to top</a></p>
									<p>© 2013 Company, Inc. · <a href="#">Privacy</a> · <a href="#">Terms</a></p>
							</footer>
							<!-- /FOOTER -->

					</div><!-- /.container -->

			</div><!-- /.container marketing-->

      <!-- Bootstrap core JavaScript
      ================================================== -->
      <!-- Placed at the end of the document so the pages load faster -->
      <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
      <script src="../js/bootstrap.min.js"></script>
      <script src="../js/holder.js"></script>	

    </body>
</html>
